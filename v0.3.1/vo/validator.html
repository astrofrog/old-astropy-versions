<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Using astropy.vo.validator &mdash; Astropy v0.3.1</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://media.readthedocs.org/css/badge_only.css" type="text/css" />
    <link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.3.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-2.0.3.min.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-migrate-1.2.1.min.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/underscore.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/doctools.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/readthedocs-doc-embed.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v0.3.1" href="../index.html" />
    <link rel="up" title="VO Simple Cone Search" href="conesearch.html" />
    <link rel="next" title="get_remote_catalog_db" href="../api/astropy.vo.client.vos_catalog.get_remote_catalog_db.html" />
    <link rel="prev" title="Using astropy.vo.client" href="client.html" />

<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'>

<!-- RTD Extra Head -->



<!-- 
Read the Docs is acting as the canonical URL for your project. 
If you want to change it, more info is available in our docs:
  http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="http://astropy.readthedocs.org/en/latest/vo/validator.html">

<script type="text/javascript">
  // This is included here because other places don't have access to the pagename variable.
  var READTHEDOCS_DATA = {
    project: "astropy",
    version: "v0.3.1",
    language: "en",
    page: "vo/validator",
    theme: "bootstrap-astropy",
    docroot: "/docs/",
    api_host: "https://readthedocs.org"
  }
  // Old variables
  var doc_version = "v0.3.1";
  var doc_slug = "astropy";
  var page_name = "vo/validator";
  var html_theme = "bootstrap-astropy";
</script>
<!-- RTD Analytics Code -->
<!-- Included in the header because you don't have a footer block. -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17997319-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<!-- end RTD Analytics Code -->


<!-- User Analytics Code -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30968842-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<!-- End User Analytics Code -->

<!-- end RTD <extrahead> -->

  </head>
  <body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="../api/astropy.vo.client.vos_catalog.get_remote_catalog_db.html" title="get_remote_catalog_db">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="client.html" title="Using astropy.vo.client">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v0.3.1</a>
	 &raquo;
      </li>
      <li><a href="index.html" >Virtual Observatory Access (<tt class="docutils literal"><span class="pre">astropy.vo</span></tt>)</a> &raquo;</li>
      <li><a href="conesearch.html" accesskey="U">VO Simple Cone Search</a> &raquo;</li>
      
      <li>Using <tt class="docutils literal"><span class="pre">astropy.vo.validator</span></tt></li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="using-astropy-vo-validator">
<h1>Using <tt class="xref py py-obj docutils literal"><span class="pre">astropy.vo.validator</span></tt><a class="headerlink" href="#using-astropy-vo-validator" title="Permalink to this headline">¶</a></h1>
<p>VO services validator is used by STScI to support <a class="reference internal" href="client.html#vo-sec-client-scs"><em>Simple Cone Search</em></a>.
Currently, only Cone Search services are supported.
A typical user should not need the validator. However, this could be used by
VO service providers to validate their services. Currently, any service
to be validated has to be registered in STScI VAO Registry.</p>
<div class="section" id="validation-for-simple-cone-search">
<span id="vo-sec-validator-validate"></span><h2>Validation for Simple Cone Search<a class="headerlink" href="#validation-for-simple-cone-search" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="conesearch.html#module-astropy.vo.validator.validate" title="astropy.vo.validator.validate"><tt class="xref py py-obj docutils literal"><span class="pre">astropy.vo.validator.validate</span></tt></a> validates VO services.
Currently, only Cone Search validation is done using
<a class="reference internal" href="../api/astropy.vo.validator.validate.check_conesearch_sites.html#astropy.vo.validator.validate.check_conesearch_sites" title="astropy.vo.validator.validate.check_conesearch_sites"><tt class="xref py py-func docutils literal"><span class="pre">check_conesearch_sites()</span></tt></a>,
which utilizes underlying <a class="reference internal" href="../io/votable/index.html#module-astropy.io.votable.validator" title="astropy.io.votable.validator"><tt class="xref py py-obj docutils literal"><span class="pre">astropy.io.votable.validator</span></tt></a> library.</p>
<p>A master list of all available Cone Search services is
obtained from <tt class="docutils literal"><span class="pre">astropy.vo.validator.validate.CS_MSTR_LIST</span></tt>, which
is a URL query to STScI VAO Registry by default.
However, by default, only the ones in <tt class="docutils literal"><span class="pre">astropy.vo.validator.validate.CS_URLS</span></tt>
are validated (also see <a class="reference internal" href="conesearch.html#vo-sec-default-scs-services"><em>Default Cone Search Services</em></a>),
while the rest are skipped. There are also options to validate
a user-defined list of services or all of them.</p>
<p>All Cone Search queries are done using RA, DEC, and SR given by
<tt class="docutils literal"><span class="pre">&lt;testQuery&gt;</span></tt> XML tag in the registry, and maximum verbosity.
In an uncommon case where <tt class="docutils literal"><span class="pre">&lt;testQuery&gt;</span></tt> is not defined for a service,
it uses a default search for <tt class="docutils literal"><span class="pre">RA=0&amp;DEC=0&amp;SR=1</span></tt>.</p>
<p>The results are separated into 4 groups below. Each group
is stored as a JSON database:</p>
<ol class="arabic">
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">conesearch_good.json</span></tt></dt>
<dd><p class="first last">Passed validation without critical warnings and
exceptions. This database residing in
<tt class="docutils literal"><span class="pre">astropy.vo.client.vos_catalog.BASEURL</span></tt> is the one used
by <a class="reference internal" href="client.html#vo-sec-client-scs"><em>Simple Cone Search</em></a> by default.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">conesearch_warn.json</span></tt></dt>
<dd><p class="first last">Has critical warnings but no exceptions. Users
can manually set
<tt class="docutils literal"><span class="pre">astropy.vo.client.conesearch.CONESEARCH_DBNAME</span></tt>
to use this at their own risk.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">conesearch_exception.json</span></tt></dt>
<dd><p class="first last">Has some exceptions. <em>Never</em> use this.
For informational purpose only.</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">conesearch_error.json</span></tt></dt>
<dd><p class="first last">Has network connection error. <em>Never</em> use this.
For informational purpose only.</p>
</dd>
</dl>
</li>
</ol>
<p>HTML pages summarizing the validation results are stored in
<tt class="docutils literal"><span class="pre">'results'</span></tt> sub-directory, which also contains downloaded XML
files from individual Cone Search queries.</p>
<div class="section" id="warnings-and-exceptions">
<h3>Warnings and Exceptions<a class="headerlink" href="#warnings-and-exceptions" title="Permalink to this headline">¶</a></h3>
<p>A subset of <a class="reference internal" href="../io/votable/api_exceptions.html#module-astropy.io.votable.exceptions" title="astropy.io.votable.exceptions"><tt class="xref py py-obj docutils literal"><span class="pre">astropy.io.votable.exceptions</span></tt></a> that is considered
non-critical is defined by <tt class="docutils literal"><span class="pre">astropy.vo.validator.validate.NONCRIT_WARNINGS</span></tt>,
which will not be flagged as bad by the validator. However,
this does not change the behavior of <tt class="docutils literal"><span class="pre">astropy.io.votable.table.PEDANTIC</span></tt>,
which still needs to be set to <tt class="docutils literal"><span class="pre">False</span></tt> for them not to be thrown out
by <a class="reference internal" href="../api/astropy.vo.client.conesearch.conesearch.html#astropy.vo.client.conesearch.conesearch" title="astropy.vo.client.conesearch.conesearch"><tt class="xref py py-func docutils literal"><span class="pre">conesearch()</span></tt></a>.
Despite being listed as non-critical, user is responsible
to check whether the results are reliable; They should not be
used blindly.</p>
<p>Some <a class="reference external" href="http://cdsarc.u-strasbg.fr/vizier/Units.htx">units recognized by VizieR</a>
are considered invalid by Cone Search standards. As a result,
they will give the warning <tt class="docutils literal"><span class="pre">'W50'</span></tt>, which is non-critical by default.</p>
<p>User can also modify <tt class="docutils literal"><span class="pre">astropy.vo.validator.validate.NONCRIT_WARNINGS</span></tt> to
include or exclude any warnings or exceptions, as desired.
However, this should be done with caution. Adding exceptions
to non-critical list is not recommended.</p>
</div>
<div class="section" id="building-the-database">
<h3>Building the Database<a class="headerlink" href="#building-the-database" title="Permalink to this headline">¶</a></h3>
<p>Each Cone Search service is a catalog in the JSON database,
which is represented by a nested dictionary:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;__version__&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s">&quot;catalogs&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;catalog 1&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;some key&quot;</span><span class="p">:</span> <span class="s">&quot;some value&quot;</span><span class="p">,</span>
            <span class="c"># ...</span>
        <span class="p">},</span>
        <span class="s">&quot;catalog 2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;some key&quot;</span><span class="p">:</span> <span class="s">&quot;some value&quot;</span><span class="p">,</span>
            <span class="c"># ...</span>
        <span class="p">},</span>
        <span class="c"># ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the master registry, there are duplicate catalog titles with
different access URLs, duplicate access URLs with different titles,
duplicate catalogs with slightly different descriptions, etc.</p>
<p>A Cone Search service is really defined by its access URL
regardless of title, description, etc. The validator ensures
each access URL is unique across all the output databases.
However, for user-friendly catalog listing, its title will be
the catalog key, not the access URL.</p>
<p>In the case of two different access URLs sharing the same title,
each URL will have its own database entry, with a sequence number
appended to their titles (e.g., &#8216;Title 1&#8217; and &#8216;Title 2&#8217;). For
consistency, even if the title does not repeat, it will still be
renamed to &#8216;Title 1&#8217;.</p>
<p>In the case of the same access URL appearing multiple times in
the registry, the validator will store the first catalog with
that access URL and throw out the rest. However, it will keep
count of the number of duplicates thrown out in the
<tt class="docutils literal"><span class="pre">'duplicatesIgnored'</span></tt> dictionary key of the catalog kept in the
database.</p>
<p>All the existing catalog tags will be copied over as dictionary
keys, except <tt class="docutils literal"><span class="pre">'accessURL'</span></tt> that is renamed to <tt class="docutils literal"><span class="pre">'url'</span></tt> for simplicity.
In addition, new keys named <tt class="docutils literal"><span class="pre">'validate_xxx'</span></tt> are added; <tt class="docutils literal"><span class="pre">'xxx'</span></tt> will
be the original attribute names of
<tt class="xref py py-obj docutils literal"><span class="pre">astropy.io.votable.validator.result.Result</span></tt>.</p>
</div>
<div class="section" id="configurable-items">
<h3>Configurable Items<a class="headerlink" href="#configurable-items" title="Permalink to this headline">¶</a></h3>
<p>These parameters are set via <a class="reference internal" href="../config/index.html#astropy-config"><em>Configuration system (astropy.config)</em></a>:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">astropy.utils.data.REMOTE_TIMEOUT</span></tt></li>
<li><tt class="docutils literal"><span class="pre">astropy.vo.validator.validate.CS_MSTR_LIST</span></tt></li>
<li><tt class="docutils literal"><span class="pre">astropy.vo.validator.validate.CS_URLS</span></tt></li>
<li><tt class="docutils literal"><span class="pre">astropy.vo.validator.validate.NONCRIT_WARNINGS</span></tt></li>
</ul>
<p>Also depends on properties in
<a class="reference internal" href="client.html#vo-sec-scs-config"><em>Simple Cone Search Configurable Items</em></a>.</p>
</div>
<div class="section" id="examples">
<span id="vo-sec-validate-examples"></span><h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.vo.validator</span> <span class="kn">import</span> <span class="n">validate</span>
</pre></div>
</div>
<p>Validate default Cone Search sites with multiprocessing
and write results in the current directory. Reading the
master registry can be slow, so setting timeout to at least
30 seconds is recommended:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.utils.data</span> <span class="kn">import</span> <span class="n">REMOTE_TIMEOUT</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">REMOTE_TIMEOUT</span><span class="o">.</span><span class="n">set_temp</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">validate</span><span class="o">.</span><span class="n">check_conesearch_sites</span><span class="p">()</span>
<span class="go">Downloading http://vao.stsci.edu/directory/NVORegInt.asmx/...</span>
<span class="go">WARNING: W20: None:2:0: W20: No version number specified in file...</span>
<span class="go"># ...</span>
<span class="go">INFO: Only 31/11144 site(s) are validated [astropy.vo.server.validate]</span>
<span class="go">Downloading http://nvo.stsci.edu/vor10/getRecord.aspx?...</span>
<span class="go"># ...</span>
<span class="go">INFO: warn: 15 catalog(s) [astropy.vo.server.validate]</span>
<span class="go">INFO: good: 15 catalog(s) [astropy.vo.server.validate]</span>
<span class="go">INFO: nerr: 1 catalog(s) [astropy.vo.server.validate]</span>
<span class="go">INFO: excp: 0 catalog(s) [astropy.vo.server.validate]</span>
<span class="go">INFO: total: 31 catalog(s) [astropy.vo.server.validate]</span>
<span class="go">INFO: Validation of 31 site(s) took 129.094 s [astropy.vo.server.validate]</span>
</pre></div>
</div>
<p>From the master registry, select Cone Search access URLs
hosted by <tt class="docutils literal"><span class="pre">'stsci.edu'</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io.votable</span> <span class="kn">import</span> <span class="n">parse_single_table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.utils.data</span> <span class="kn">import</span> <span class="n">get_readable_fileobj</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">REMOTE_TIMEOUT</span><span class="o">.</span><span class="n">set_temp</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">get_readable_fileobj</span><span class="p">(</span><span class="n">validate</span><span class="o">.</span><span class="n">CS_MSTR_LIST</span><span class="p">(),</span>
<span class="gp">... </span>                              <span class="n">encoding</span><span class="o">=</span><span class="s">&#39;binary&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">tab_all</span> <span class="o">=</span> <span class="n">parse_single_table</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
<span class="go">Downloading http://vao.stsci.edu/directory/NVORegInt.asmx/...</span>
<span class="go">|===========================================|  23M/ 23M (100.00%)        00s</span>
<span class="go">WARNING: W20: None:2:0: W20: No version number specified in file...</span>
<span class="go"># ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">tab_all</span><span class="o">.</span><span class="n">array</span><span class="o">.</span><span class="n">data</span><span class="p">[</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">tab_all</span><span class="o">.</span><span class="n">array</span><span class="p">[</span><span class="s">&#39;capabilityClass&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span><span class="s">&#39;ConeSearch&#39;</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">[</span><span class="s">&#39;accessURL&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="n">b</span><span class="s">&#39;stsci.edu&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">urls</span>
<span class="go">[&#39;http://archive.stsci.edu/hst/search.php?sci_data_set_name=Y*&amp;amp;&#39;,</span>
<span class="go"> &#39;http://archive.stsci.edu/tues/search.php?&#39;,</span>
<span class="go"> &#39;http://archive.stsci.edu/hst/search.php?sci_data_set_name=J*&amp;amp;&#39;,</span>
<span class="go"> &#39;http://archive.stsci.edu/hut/search.php?&#39;, ...,</span>
<span class="go"> &#39;http://archive.stsci.edu/kepler/kepler_fov/search.php?&#39;,</span>
<span class="go"> &#39;http://archive.stsci.edu/kepler/confirmed_planets/search.php?&#39;]</span>
</pre></div>
</div>
<p>Validate only the URLs found above without verbose
outputs (except warnings that are controlled by <a class="reference external" href="http://docs.python.org/library/warnings.html#module-warnings" title="(in Python v2.7)"><tt class="xref py py-mod docutils literal"><span class="pre">warnings</span></tt></a>)
or multiprocessing, and write results in
<tt class="docutils literal"><span class="pre">'subset'</span></tt> sub-directory instead of the current directory:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">REMOTE_TIMEOUT</span><span class="o">.</span><span class="n">set_temp</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">validate</span><span class="o">.</span><span class="n">check_conesearch_sites</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">destdir</span><span class="o">=</span><span class="s">&#39;./subset&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">parallel</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">url_list</span><span class="o">=</span><span class="n">urls</span><span class="p">)</span>
<span class="go">WARNING: W49: ... Empty cell illegal for integer fields...</span>
<span class="go"># ...</span>
</pre></div>
</div>
<p>Add <tt class="docutils literal"><span class="pre">'W24'</span></tt> from <a class="reference internal" href="../io/votable/api_exceptions.html#module-astropy.io.votable.exceptions" title="astropy.io.votable.exceptions"><tt class="xref py py-obj docutils literal"><span class="pre">astropy.io.votable.exceptions</span></tt></a> to the list of
non-critical warnings to be ignored and re-run default validation.
This is <em>not</em> recommended unless you know exactly what you are doing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">validate</span><span class="o">.</span><span class="n">NONCRIT_WARNINGS</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">validate</span><span class="o">.</span><span class="n">NONCRIT_WARNINGS</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="s">&#39;W24&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">REMOTE_TIMEOUT</span><span class="o">.</span><span class="n">set_temp</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">validate</span><span class="o">.</span><span class="n">check_conesearch_sites</span><span class="p">()</span>
</pre></div>
</div>
<p>Reset the list of ignored warnings back to default value.
Validate <em>all</em> Cone Search services in the master registry
(this will take a while) and write results in <tt class="docutils literal"><span class="pre">'all'</span></tt> sub-directory:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">validate</span><span class="o">.</span><span class="n">NONCRIT_WARNINGS</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">validate</span><span class="o">.</span><span class="n">NONCRIT_WARNINGS</span><span class="o">.</span><span class="n">defaultvalue</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">REMOTE_TIMEOUT</span><span class="o">.</span><span class="n">set_temp</span><span class="p">(</span><span class="mi">30</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">validate</span><span class="o">.</span><span class="n">check_conesearch_sites</span><span class="p">(</span><span class="n">destdir</span><span class="o">=</span><span class="s">&#39;./all&#39;</span><span class="p">,</span> <span class="n">url_list</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
</pre></div>
</div>
<p>To look at the HTML pages of the validation results in the current
directory using Firefox browser (images shown are from STScI server
but your own results should look similar):</p>
<div class="highlight-python"><pre>firefox results/index.html</pre>
</div>
<a class="reference internal image-reference" href="../_images/validator_html_1.png"><img alt="Main HTML page of validation results" src="../_images/validator_html_1.png" style="width: 600px;" /></a>
<p>When you click on &#8216;All tests&#8217; from the page above, you will see all the
Cone Search services validated with a summary of validation results:</p>
<a class="reference internal image-reference" href="../_images/validator_html_2.png"><img alt="All tests HTML page" src="../_images/validator_html_2.png" style="width: 600px;" /></a>
<p>When you click on any of the listed URLs from above, you will see
detailed validation warnings and exceptions for the selected URL:</p>
<a class="reference internal image-reference" href="../_images/validator_html_3.png"><img alt="Detailed validation warnings HTML page" src="../_images/validator_html_3.png" style="width: 600px;" /></a>
<p>When you click on the URL on top of the page above, you will see
the actual VO Table returned by the Cone Search query:</p>
<a class="reference internal image-reference" href="../_images/validator_html_4.png"><img alt="VOTABLE XML page" src="../_images/validator_html_4.png" style="width: 600px;" /></a>
</div>
</div>
<div class="section" id="inspection-of-validation-results">
<span id="vo-sec-validator-inspect"></span><h2>Inspection of Validation Results<a class="headerlink" href="#inspection-of-validation-results" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="conesearch.html#module-astropy.vo.validator.inspect" title="astropy.vo.validator.inspect"><tt class="xref py py-obj docutils literal"><span class="pre">inspect</span></tt></a> inspects results from
<a class="reference internal" href="#vo-sec-validator-validate"><em>Validation for Simple Cone Search</em></a>. It reads in JSON databases
residing in <tt class="docutils literal"><span class="pre">astropy.vo.client.vos_catalog.BASEURL</span></tt>, which
can be changed to point to a different location.</p>
<div class="section" id="id1">
<h3>Configurable Items<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>This parameter is set via <a class="reference internal" href="../config/index.html#astropy-config"><em>Configuration system (astropy.config)</em></a>:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">astropy.vo.client.vos_catalog.BASEURL</span></tt></li>
</ul>
</div>
<div class="section" id="id2">
<h3>Examples<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Load Cone Search validation results from
<tt class="docutils literal"><span class="pre">astropy.vo.client.vos_catalog.BASEURL</span></tt>
(by default, the one used by <a class="reference internal" href="client.html#vo-sec-client-scs"><em>Simple Cone Search</em></a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.vo.validator</span> <span class="kn">import</span> <span class="n">inspect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">ConeSearchResults</span><span class="p">()</span>
<span class="go">Downloading .../conesearch_good.json</span>
<span class="go">|============================================|  56/ 56k (100.00%)        00s</span>
<span class="go">Downloading .../conesearch_warn.json</span>
<span class="go">|============================================|  94/ 94k (100.00%)        00s</span>
<span class="go">Downloading .../conesearch_exception.json</span>
<span class="go">|============================================|  45/ 45  (100.00%)        00s</span>
<span class="go">Downloading .../conesearch_error.json</span>
<span class="go">|============================================|   1/  1k (100.00%)        00s</span>
</pre></div>
</div>
<p>Print tally. In this example, there are 15 Cone Search services that
passed validation with non-critical warnings, 15 with critical warnings,
none with exceptions, and 1 with network error:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">tally</span><span class="p">()</span>
<span class="go">good: 15 catalog(s)</span>
<span class="go">warn: 15 catalog(s)</span>
<span class="go">exception: 0 catalog(s)</span>
<span class="go">error: 1 catalog(s)</span>
<span class="go">total: 31 catalog(s)</span>
</pre></div>
</div>
<p>Print a list of good Cone Search catalogs, each with title, access URL,
warning codes collected, and individual warnings:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">list_cats</span><span class="p">(</span><span class="s">&#39;good&#39;</span><span class="p">)</span>
<span class="go">Guide Star Catalog 2.3 1</span>
<span class="go">http://gsss.stsci.edu/webservices/vo/ConeSearch.aspx?CAT=GSC23&amp;</span>
<span class="go">W48,W50</span>
<span class="go">.../vo.xml:136:0: W50: Invalid unit string &#39;pixel&#39;</span>
<span class="go">.../vo.xml:155:0: W48: Unknown attribute &#39;nrows&#39; on TABLEDATA</span>
<span class="go"># ...</span>
<span class="go">USNO-A2 Catalogue 1</span>
<span class="go">http://www.nofs.navy.mil/cgi-bin/vo_cone.cgi?CAT=USNO-A2&amp;</span>
<span class="go">W17,W42,W21</span>
<span class="go">.../vo.xml:4:0: W21: vo.table is designed for VOTable version 1.1 and 1.2...</span>
<span class="go">.../vo.xml:4:0: W42: No XML namespace specified</span>
<span class="go">.../vo.xml:15:15: W17: VOTABLE element contains more than one DESCRIPTION...</span>
</pre></div>
</div>
<p>List Cone Search catalogs with warnings, excluding warnings that
were ignored in <tt class="docutils literal"><span class="pre">astropy.vo.validator.validate.NONCRIT_WARNINGS</span></tt>,
and writes the output to a file named <tt class="docutils literal"><span class="pre">'warn_cats.txt'</span></tt> in the current
directory. This is useful to see why the services failed validations:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;warn_cats.txt&#39;</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">r</span><span class="o">.</span><span class="n">list_cats</span><span class="p">(</span><span class="s">&#39;warn&#39;</span><span class="p">,</span> <span class="n">fout</span><span class="o">=</span><span class="n">fout</span><span class="p">,</span> <span class="n">ignore_noncrit</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>List the titles of all good Cone Search catalogs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">catkeys</span><span class="p">[</span><span class="s">&#39;good&#39;</span><span class="p">]</span>
<span class="go">[u&#39;Guide Star Catalog 2.3 1&#39;,</span>
<span class="go"> u&#39;SDSS DR7 - Sloan Digital Sky Survey Data Release 7 1&#39;,</span>
<span class="go"> u&#39;SDSS DR7 - Sloan Digital Sky Survey Data Release 7 2&#39;,</span>
<span class="go"> u&#39;SDSS DR7 - Sloan Digital Sky Survey Data Release 7 3&#39;, ...,</span>
<span class="go"> u&#39;USNO-A2 Catalogue 1&#39;]</span>
</pre></div>
</div>
<p>Print the details of catalog titled <tt class="docutils literal"><span class="pre">'USNO-A2</span> <span class="pre">Catalogue</span> <span class="pre">1'</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">print_cat</span><span class="p">(</span><span class="s">&#39;USNO-A2 Catalogue 1&#39;</span><span class="p">)</span>
<span class="go">{</span>
<span class="go">    &quot;capabilityClass&quot;: &quot;ConeSearch&quot;,</span>
<span class="go">    &quot;capabilityStandardID&quot;: &quot;ivo://ivoa.net/std/ConeSearch&quot;,</span>
<span class="go">    &quot;capabilityValidationLevel&quot;: &quot;&quot;,</span>
<span class="go">    &quot;contentLevel&quot;: &quot;#University#Research#Amateur#&quot;,</span>
<span class="go">    # ...</span>
<span class="go">    &quot;version&quot;: &quot;&quot;,</span>
<span class="go">    &quot;waveband&quot;: &quot;#Optical#&quot;</span>
<span class="go">}</span>
<span class="go">Found in good</span>
</pre></div>
</div>
<p>Load Cone Search validation results from a local directory named <tt class="docutils literal"><span class="pre">'subset'</span></tt>.
This is useful if you ran your own <a class="reference internal" href="#vo-sec-validator-validate"><em>Validation for Simple Cone Search</em></a>
and wish to inspect the output databases. This example reads in
validation of STScI Cone Search services done in
<a class="reference internal" href="#vo-sec-validate-examples"><em>Validation for Simple Cone Search Examples</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.vo.client.vos_catalog</span> <span class="kn">import</span> <span class="n">BASEURL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">BASEURL</span><span class="o">.</span><span class="n">set_temp</span><span class="p">(</span><span class="s">&#39;./subset/&#39;</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">r</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">ConeSearchResults</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">tally</span><span class="p">()</span>
<span class="go">good: 21 catalog(s)</span>
<span class="go">warn: 7 catalog(s)</span>
<span class="go">exception: 0 catalog(s)</span>
<span class="go">error: 0 catalog(s)</span>
<span class="go">total: 28 catalog(s)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">catkeys</span><span class="p">[</span><span class="s">&#39;good&#39;</span><span class="p">]</span>
<span class="go">[u&#39;Advanced Camera for Surveys 1&#39;,</span>
<span class="go"> u&#39;Berkeley Extreme and Far-UV Spectrometer 1&#39;,</span>
<span class="go"> u&#39;Copernicus Satellite 1&#39;,</span>
<span class="go"> u&#39;Extreme Ultraviolet Explorer 1&#39;, ...,</span>
<span class="go"> u&#39;Wisconsin Ultraviolet Photo-Polarimeter Experiment 1&#39;]</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Using <tt class="docutils literal"><span class="pre">astropy.vo.validator</span></tt></a><ul>
<li><a class="reference internal" href="#validation-for-simple-cone-search">Validation for Simple Cone Search</a><ul>
<li><a class="reference internal" href="#warnings-and-exceptions">Warnings and Exceptions</a></li>
<li><a class="reference internal" href="#building-the-database">Building the Database</a></li>
<li><a class="reference internal" href="#configurable-items">Configurable Items</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#inspection-of-validation-results">Inspection of Validation Results</a><ul>
<li><a class="reference internal" href="#id1">Configurable Items</a></li>
<li><a class="reference internal" href="#id2">Examples</a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="http://github.com/astropy/astropy/tree/v0.3.x/docs/vo/validator.rst">Edit This Page on Github</a> &nbsp;
    <a href="../_sources/vo/validator.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2013, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2. &nbsp;
    Last built 05 Mar 2014. <br/>
  </p>
</footer>
  </body>
</html>