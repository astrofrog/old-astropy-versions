<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>sigma_clip &mdash; Astropy v0.3.1</title>
    
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="https://media.readthedocs.org/css/badge_only.css" type="text/css" />
    <link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.3.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-2.0.3.min.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/jquery/jquery-migrate-1.2.1.min.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/underscore.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/doctools.js"></script>
    <script type="text/javascript" src="https://media.readthedocs.org/javascript/readthedocs-doc-embed.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="top" title="Astropy v0.3.1" href="../index.html" />
    <link rel="up" title="Astrostatistics Tools (astropy.stats)" href="../stats/index.html" />
    <link rel="next" title="signal_to_noise_oir_ccd" href="astropy.stats.funcs.signal_to_noise_oir_ccd.html" />
    <link rel="prev" title="median_absolute_deviation" href="astropy.stats.funcs.median_absolute_deviation.html" />

<link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'>

<!-- RTD Extra Head -->



<!-- 
Read the Docs is acting as the canonical URL for your project. 
If you want to change it, more info is available in our docs:
  http://docs.readthedocs.org/en/latest/canonical.html
-->
<link rel="canonical" href="http://astropy.readthedocs.org/en/latest/api/astropy.stats.funcs.sigma_clip.html">

<script type="text/javascript">
  // This is included here because other places don't have access to the pagename variable.
  var READTHEDOCS_DATA = {
    project: "astropy",
    version: "v0.3.1",
    language: "en",
    page: "api/astropy.stats.funcs.sigma_clip",
    theme: "bootstrap-astropy",
    docroot: "/docs/",
    api_host: "https://readthedocs.org"
  }
  // Old variables
  var doc_version = "v0.3.1";
  var doc_slug = "astropy";
  var page_name = "api/astropy.stats.funcs.sigma_clip";
  var html_theme = "bootstrap-astropy";
</script>
<!-- RTD Analytics Code -->
<!-- Included in the header because you don't have a footer block. -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-17997319-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<!-- end RTD Analytics Code -->


<!-- User Analytics Code -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30968842-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<!-- End User Analytics Code -->

<!-- end RTD <extrahead> -->

  </head>
  <body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="astropy.stats.funcs.signal_to_noise_oir_ccd.html" title="signal_to_noise_oir_ccd">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="astropy.stats.funcs.median_absolute_deviation.html" title="median_absolute_deviation">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v0.3.1</a>
	 &raquo;
      </li>
      <li><a href="../stats/index.html" accesskey="U">Astrostatistics Tools (<tt class="docutils literal"><span class="pre">astropy.stats</span></tt>)</a> &raquo;</li>
      
      <li>sigma_clip</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="sigma-clip">
<h1>sigma_clip<a class="headerlink" href="#sigma-clip" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="astropy.stats.funcs.sigma_clip">
<tt class="descclassname">astropy.stats.funcs.</tt><tt class="descname">sigma_clip</tt><big>(</big><em>data</em>, <em>sig=3</em>, <em>iters=1</em>, <em>cenfunc=&lt;function median at 0x18c9230&gt;</em>, <em>varfunc=&lt;function var at 0x178e1b8&gt;</em>, <em>axis=None</em>, <em>copy=True</em><big>)</big><a class="reference internal" href="../_modules/astropy/stats/funcs.html#sigma_clip"><span class="viewcode-link">[source]</span></a><a class="reference external" href="http://github.com/astropy/astropy/tree/v0.3.x/astropy/stats/funcs.py#L28" title="Push the Edit button on the next page"><span class="edit-on-github viewcode-link">&nbsp;[edit on github]</span></a><a class="headerlink" href="#astropy.stats.funcs.sigma_clip" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform sigma-clipping on the provided data.</p>
<p>This performs the sigma clipping algorithm - i.e. the data will be iterated
over, each time rejecting points that are more than a specified number of
standard deviations discrepant.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><tt class="xref py py-obj docutils literal"><span class="pre">scipy.stats.sigmaclip</span></tt> provides a subset of the functionality in this
function.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> : array-like</p>
<blockquote>
<div><p>The data to be sigma-clipped (any shape).</p>
</div></blockquote>
<p><strong>sig</strong> : float</p>
<blockquote>
<div><p>The number of standard deviations (<em>not</em> variances) to use as the
clipping limit.</p>
</div></blockquote>
<p><strong>iters</strong> : int or None</p>
<blockquote>
<div><p>The number of iterations to perform clipping for, or None to clip until
convergence is achieved (i.e. continue until the last iteration clips
nothing).</p>
</div></blockquote>
<p><strong>cenfunc</strong> : callable</p>
<blockquote>
<div><p>The technique to compute the center for the clipping. Must be a
callable that takes in a masked array and outputs the central value.
Defaults to the median (numpy.median).</p>
</div></blockquote>
<p><strong>varfunc</strong> : callable</p>
<blockquote>
<div><p>The technique to compute the standard deviation about the center. Must
be a callable that takes in a masked array and outputs a width
estimator.  Defaults to the standard deviation (numpy.var).</p>
</div></blockquote>
<p><strong>axis</strong> : int or None</p>
<blockquote>
<div><p>If not None, clip along the given axis.  For this case, axis=int will
be passed on to cenfunc and varfunc, which are expected to return an
array with the axis dimension removed (like the numpy functions).
If None, clip over all values.  Defaults to None.</p>
</div></blockquote>
<p><strong>copy</strong> : bool</p>
<blockquote>
<div><p>If True, the data array will be copied.  If False, the masked array
data will contain the same array as <tt class="xref py py-obj docutils literal"><span class="pre">data</span></tt>.  Defaults to True.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>filtered_data</strong> : <tt class="xref py py-obj docutils literal"><span class="pre">numpy.masked.MaskedArray</span></tt></p>
<blockquote class="last">
<div><p>A masked array with the same shape as <tt class="xref py py-obj docutils literal"><span class="pre">data</span></tt> input, where the points
rejected by the algorithm have been masked.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<ol class="arabic">
<li><p class="first">The routine works by calculating</p>
<blockquote>
<div><p>deviation = data - cenfunc(data [,axis=int])</p>
</div></blockquote>
<p>and then setting a mask for points outside the range</p>
<blockquote>
<div><p>data.mask = deviation**2 &gt; sig**2 * varfunc(deviation)</p>
</div></blockquote>
<p>It will iterate a given number of times, or until no further points are
rejected.</p>
</li>
<li><p class="first">Most numpy functions deal well with masked arrays, but if one would
like to have an array with just the good (or bad) values, one can use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">good_only</span> <span class="o">=</span> <span class="n">filtered_data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">filtered_data</span><span class="o">.</span><span class="n">mask</span><span class="p">]</span>
<span class="n">bad_only</span> <span class="o">=</span> <span class="n">filtered_data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">filtered_data</span><span class="o">.</span><span class="n">mask</span><span class="p">]</span>
</pre></div>
</div>
<p>However, for multidimensional data, this flattens the array, which may
not be what one wants (especially is filtering was done along an axis).</p>
</li>
</ol>
<p class="rubric">Examples</p>
<p>This will generate random variates from a Gaussian distribution and return
a masked array in which all points that are more than 2 <em>sample</em> standard
deviation from the median are masked:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.stats</span> <span class="kn">import</span> <span class="n">sigma_clip</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">randn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">randvar</span> <span class="o">=</span> <span class="n">randn</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_data</span> <span class="o">=</span> <span class="n">sigma_clip</span><span class="p">(</span><span class="n">randvar</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>This will clipping on a similar distribution, but for 3 sigma relative to
the sample <em>mean</em>, will clip until converged, and does not copy the data:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.stats</span> <span class="kn">import</span> <span class="n">sigma_clip</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">randn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">mean</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">randvar</span> <span class="o">=</span> <span class="n">randn</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_data</span> <span class="o">=</span> <span class="n">sigma_clip</span><span class="p">(</span><span class="n">randvar</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>This will clip along one axis on a similar distribution with bad points
inserted:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.stats</span> <span class="kn">import</span> <span class="n">sigma_clip</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">arange</span><span class="p">,</span> <span class="n">diag</span><span class="p">,</span> <span class="n">ones</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">+</span><span class="n">diag</span><span class="p">(</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filtered_data</span> <span class="o">=</span> <span class="n">sigma_clip</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="mf">2.3</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that along the other axis, no points would be masked, as the variance
is higher.</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">sigma_clip</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="http://github.com/astropy/astropy/tree/v0.3.x/docs/api/astropy.stats.funcs.sigma_clip.rst">Edit This Page on Github</a> &nbsp;
    <a href="../_sources/api/astropy.stats.funcs.sigma_clip.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011-2013, The Astropy Developers.<br/>
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2. &nbsp;
    Last built 05 Mar 2014. <br/>
  </p>
</footer>
  </body>
</html>